$(document).ready(function(){var b=$("#myform"),a=$('input[name="files"]');a.fileuploader({addMore:true,changeInput:'<div class="fileuploader-input"><div class="fileuploader-input-inner"><div>${captions.feedback} ${captions.or} <span>${captions.button}</span></div></div></div>',theme:"dropin",enableApi:true,onRemove:function(c){if(c.data.uploaded){$.post("./php/ajax_remove_file.php",{file:c.name})}},captions:{feedback:"Drag and drop files here",or:"or",button:"Browse Files"}});b.on("submit",function(g){g.preventDefault();var f=new FormData(),d=$.fileuploader.getInstance(a),c=[];$.each(b.find("[name]:input"),function(j,e){var o=$(e),h=o.attr("name"),l=o.attr("type")||"",n=o.val();if($.inArray(h,c)>0){return}c.push(h);if(typeof n=="undefined"){return true}if(l=="file"){if(h==a.attr("name")){var m=d.getChoosedFiles();for(var k=0;k<m.length;k++){f.append(h,m[k].file,(m[k].name?m[k].name:false))}d.disable(true)}}else{f.append(h,n)}});$.ajax({url:b.attr("action")||"#",data:f,type:b.attr("method")||"POST",enctype:b.attr("enctype")||"multipart/form-data",cache:false,contentType:false,processData:false,beforeSend:function(){b.find(".form-status").html('<div class="progressbar-holder"><div class="progressbar"></div></div>');b.find('input[type="submit"]').attr("disabled","disabled")},xhr:function(){var e=$.ajaxSettings.xhr();if(e.upload){e.upload.addEventListener("progress",this.progress,false)}return e},success:function(h,o,l){try{var m=JSON.parse(h);for(var k in m){if(m[k].files){if(k==a.attr("name").replace("[]","")){for(var j=0;j<m[k].files.length;j++){$.each(d.getChoosedFiles(),function(e,i){if(m[k].files[j].old_name==i.name){i.name=m[k].files[j].name;i.html.find(".column-title > div:first-child").text(m[k].files[j].name).attr("title",m[k].files[0].name)}i.data.uploaded=true})}d.updateFileList()}}else{b.find('[name="'+k+'"]:input').val(m[k])}}}catch(n){}d.enable();b.find(".form-status").html('<p class="text-success">Success!</p>');b.find('input[type="submit"]').removeAttr("disabled")},error:function(e,i,h){b.find(".form-status").html('<p class="text-error">Error!</p>');b.find('input[type="submit"]').removeAttr("disabled")},progress:function(i){if(i.lengthComputable){var h=Math.round(i.loaded*100/i.total).toString();b.find(".form-status .progressbar").css("width",h+"%")}}})})});