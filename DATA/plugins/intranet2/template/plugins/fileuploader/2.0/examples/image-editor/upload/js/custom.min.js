$(document).ready(function(){var a=function(b){if(b.upload&&b.upload.status=="loading"){return b.editor.isUploadPending=true}if(!b.appended&&!b.uploaded){return}if(!b.editor||!b.reader.width){return}if(b.upload&&b.upload.resend){b.upload.resend()}if(b.appended){b.imageIsUploading=true;b.image.addClass("fileuploader-loading").html("");b.html.find(".fileuploader-action-popup").hide();$.post("php/ajax_resize_file.php",{_file:b.file,_editor:JSON.stringify(b.editor),fileuploader:1},function(){b.reader.read(function(){delete b.imageIsUploading;b.html.find(".fileuploader-action-popup").show();b.popup.html=b.popup.editor=b.editor.crop=b.editor.rotation=null;b.renderThumbnail()},null,true)})}};$('input[name="files"]').fileuploader({extensions:["jpg","jpeg","png","gif"],changeInput:'<div class="fileuploader-input"><div class="fileuploader-input-inner"><div class="fileuploader-main-icon"></div><h3 class="fileuploader-input-caption"><span>${captions.feedback}</span></h3><p>${captions.or}</p><div class="fileuploader-input-button"><span>${captions.button}</span></div></div></div>',theme:"dragdrop",thumbnails:{onImageLoaded:function(b){if(!b.html.find(".fileuploader-action-edit").length){b.html.find(".fileuploader-action-remove").before('<a class="fileuploader-action fileuploader-action-popup fileuploader-action-edit" title="Edit"><i></i></a>')}if(b.imageIsUploading){b.image.addClass("fileuploader-loading").html("")}}},upload:{url:"php/ajax_upload_file.php",data:null,type:"POST",enctype:"multipart/form-data",start:true,synchron:true,beforeSend:function(b){if(b.editor&&(typeof b.editor.rotation!="undefined"||b.editor.crop)){b.upload.data.fileuploader=1;b.upload.data._editorr=JSON.stringify(b.editor)}b.html.find(".fileuploader-action-success").removeClass("fileuploader-action-success")},onSuccess:function(b,d){var f={};try{f=JSON.parse(b)}catch(g){f.hasWarnings=true}if(f.isSuccess&&f.files[0]){d.name=f.files[0].name;d.html.find(".column-title > div:first-child").text(f.files[0].name).attr("title",f.files[0].name);if(d.editor&&d.editor.isUploadPending){delete d.editor.isUploadPending;a(d)}}if(f.hasWarnings){for(var c in f.warnings){alert(f.warnings)}d.html.removeClass("upload-successful").addClass("upload-failed");return this.onError?this.onError(d):null}d.html.find(".fileuploader-action-remove").addClass("fileuploader-action-success");setTimeout(function(){d.html.find(".progress-bar2").fadeOut(400)},400)},onError:function(b){var c=b.html.find(".progress-bar2");if(c.length){c.find("span").html(0+"%");c.find(".fileuploader-progressbar .bar").width(0+"%");b.html.find(".progress-bar2").fadeOut(400)}b.upload.status!="cancelled"&&b.html.find(".fileuploader-action-retry").length==0?b.html.find(".column-actions").prepend('<a class="fileuploader-action fileuploader-action-retry" title="Retry"><i></i></a>'):null},onProgress:function(c,b){var d=b.html.find(".progress-bar2");if(d.length>0){d.show();d.find("span").html(c.percentage+"%");d.find(".fileuploader-progressbar .bar").width(c.percentage+"%")}},onComplete:null},onRemove:function(b){$.post("./php/ajax_remove_file.php",{file:b.name})},editor:{cropper:{showGrid:true},onSave:function(c,b){a(b)}},captions:{feedback:"Drag and drop files here",feedback2:"Drag and drop files here",drop:"Drag and drop files here",or:"or",button:"Browse files"}})});