"use strict";(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(c){var g=c.defined,f=c.each,h=c.extend,b=c.seriesType,d=c.pick,e=c.Point;b("sankey","column",{colorByPoint:true,curveFactor:0.33,dataLabels:{enabled:true,backgroundColor:"none",crop:false,nodeFormat:undefined,nodeFormatter:function(){return this.point.name},format:undefined,formatter:function(){return""},inside:true},linkOpacity:0.5,nodeWidth:20,nodePadding:10,showInLegend:false,states:{hover:{linkOpacity:1}},tooltip:{followPointer:true,headerFormat:'<span style="font-size: 0.85em">{series.name}</span><br/>',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: <b>{point.weight}</b><br/>",nodeFormat:"{point.name}: <b>{point.sum}</b><br/>"}},{isCartesian:false,forceDL:true,createNode:function(l){function j(m,n){return c.find(m,function(o){return o.id===n})}var k=j(this.nodes,l),i;if(!k){i=this.options.nodes&&j(this.options.nodes,l);k=(new e()).init(this,h({className:"highcharts-node",isNode:true,id:l,y:1},i));k.linksTo=[];k.linksFrom=[];k.formatPrefix="node";k.name=k.name||k.id;k.getSum=function(){var n=0,m=0;f(k.linksTo,function(o){n+=o.weight});f(k.linksFrom,function(o){m+=o.weight});return Math.max(n,m)};k.offset=function(m,o){var p=0;for(var n=0;n<k[o].length;n++){if(k[o][n]===m){return p}p+=k[o][n].weight}};k.hasShape=function(){var m=0;f(k.linksTo,function(n){if(n.outgoing){m++}});return !k.linksTo.length||m!==k.linksTo.length};this.nodes.push(k)}return k},createNodeColumn:function(){var k=this.chart,j=[],i=this.options.nodePadding;j.sum=function(){var l=0;f(this,function(m){l+=m.getSum()});return l};j.offset=function(n,m){var o=0;for(var l=0;l<j.length;l++){if(j[l]===n){return o+(n.options.offset||0)}o+=j[l].getSum()*m+i}};j.top=function(n){var l=0;for(var m=0;m<j.length;m++){if(m>0){l+=i}l+=j[m].getSum()*n}return(k.plotSizeY-l)/2};return j},createNodeColumns:function(){var i=[];f(this.nodes,function(l){var m=-1,k,j;if(!c.defined(l.options.column)){if(l.linksTo.length===0){l.column=0}else{for(k=0;k<l.linksTo.length;k++){j=l.linksTo[0];if(j.fromNode.column>m){m=j.fromNode.column}}l.column=m+1}}if(!i[l.column]){i[l.column]=this.createNodeColumn()}i[l.column].push(l)},this);return i},pointAttribs:function(i,k){var j=this.options.linkOpacity;if(k){j=this.options.states[k].linkOpacity||j}return{fill:i.isNode?i.color:c.color(i.color).setOpacity(j).get()}},generatePoints:function(){var i={};c.Series.prototype.generatePoints.call(this);if(!this.nodes){this.nodes=[]}this.colorCounter=0;f(this.nodes,function(j){j.linksFrom.length=0;j.linksTo.length=0});f(this.points,function(j){if(g(j.from)){if(!i[j.from]){i[j.from]=this.createNode(j.from)}i[j.from].linksFrom.push(j);j.fromNode=i[j.from];j.color=j.options.color||i[j.from].color}if(g(j.to)){if(!i[j.to]){i[j.to]=this.createNode(j.to)}i[j.to].linksTo.push(j);j.toNode=i[j.to]}j.name=j.name||j.id},this)},translate:function(){if(!this.processedXData){this.processData()}this.generatePoints();this.nodeColumns=this.createNodeColumns();var m=this.chart,k=m.inverted,q=this.options,j=0,p=q.nodeWidth,o=this.nodeColumns,i=(m.plotSizeX-p)/(o.length-1),l=((k?-i:i)*q.curveFactor),n=Infinity;f(this.nodeColumns,function(s){var r=m.plotSizeY-(s.length-1)*q.nodePadding;n=Math.min(n,r/s.sum())});f(this.nodeColumns,function(r){f(r,function(w){var v=w.getSum(),s=v*n,t=(r.top(n)+r.offset(w,n)),u=k?m.plotSizeX-j:j;w.sum=v;w.shapeType="rect";if(!k){w.shapeArgs={x:u,y:t,width:p,height:s}}else{w.shapeArgs={x:u-p,y:m.plotSizeY-t-s,width:p,height:s}}w.shapeArgs.display=w.hasShape()?"":"none";w.plotY=1;f(w.linksFrom,function(S){var D=S.weight*n,C=w.offset(S,"linksFrom")*n,K=t+C,Q=S.toNode,W=o[Q.column].top(n),A=(W+(Q.offset(S,"linksTo")*n)+o[Q.column].offset(Q,n)),E=p,ac=Q.column*i,L=S.outgoing;if(k){K=m.plotSizeY-K;A=m.plotSizeY-A;ac=m.plotSizeX-ac;E=-E;D=-D}S.shapeType="path";if(ac>j){S.shapeArgs={d:["M",u+E,K,"C",u+E+l,K,ac-l,A,ac,A,"L",ac+(L?E:0),A+D/2,"L",ac,A+D,"C",ac-l,A+D,u+E+l,K+D,u+E,K+D,"z"]}}else{var Y=20,T=m.plotHeight-K-D,aa=ac-Y-D,Z=ac-Y,X=ac,V=u+E,U=V+Y,R=U+D,P=K,N=K+D,J=N+Y,B=J+T,z=B+Y,x=z+D,I=A,G=I+D,F=G+Y,H=N-D*0.7,ab=z+D*0.7,y=G-D*0.7,O=X-D*0.7,M=V+D*0.7;S.shapeArgs={d:["M",V,P,"C",M,P,R,H,R,J,"L",R,B,"C",R,ab,M,x,V,x,"L",X,x,"C",O,x,aa,ab,aa,B,"L",aa,F,"C",aa,y,O,I,X,I,"L",X,G,"C",Z,G,Z,G,Z,F,"L",Z,B,"C",Z,z,Z,z,X,z,"L",V,z,"C",U,z,U,z,U,B,"L",U,J,"C",U,N,U,N,V,N,"z"]}}S.dlBox={x:u+(ac-u+E)/2,y:K+(A-K)/2,height:D,width:0};S.y=S.plotY=1;if(!S.color){S.color=w.color}})});j+=i},this)},render:function(){var i=this.points;this.points=this.points.concat(this.nodes);c.seriesTypes.column.prototype.render.call(this);this.points=i},animate:c.Series.prototype.animate},{getClassName:function(){return"highcharts-link "+e.prototype.getClassName.call(this)},isValid:function(){return this.isNode||typeof this.weight==="number"}})}(a));return(function(){}())}));