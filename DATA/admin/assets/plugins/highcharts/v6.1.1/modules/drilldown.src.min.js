"use strict";(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(i){var g=i.animObject,d=i.noop,l=i.color,r=i.defaultOptions,e=i.each,q=i.extend,m=i.format,j=i.objectEach,f=i.pick,p=i.Chart,t=i.seriesTypes,n=t.pie,c=t.column,b=i.Tick,u=i.fireEvent,o=i.inArray,k=1;q(r.lang,{drillUpText:"◁ Back to {series.name}"});r.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},activeDataLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}};i.SVGRenderer.prototype.Element.prototype.fadeIn=function(v){this.attr({opacity:0.1,visibility:"inherit"}).animate({opacity:f(this.newOpacity,1)},v||{duration:250})};p.prototype.addSeriesAsDrilldown=function(v,w){this.addSingleSeriesAsDrilldown(v,w);this.applyDrilldown()};p.prototype.addSingleSeriesAsDrilldown=function(E,H){var B=E.series,y=B.xAxis,w=B.yAxis,C,D,A=[],z=[],v,x,F,G;G={color:E.color||B.color};if(!this.drilldownLevels){this.drilldownLevels=[]}x=B.options._levelNumber||0;F=this.drilldownLevels[this.drilldownLevels.length-1];if(F&&F.levelNumber!==x){F=undefined}H=q(q({_ddSeriesId:k++},G),H);D=o(E,B.points);e(B.chart.series,function(I){if(I.xAxis===y&&!I.isDrilling){I.options._ddSeriesId=I.options._ddSeriesId||k++;I.options._colorIndex=I.userOptions._colorIndex;I.options._levelNumber=I.options._levelNumber||x;if(F){A=F.levelSeries;z=F.levelSeriesOptions}else{A.push(I);z.push(I.options)}}});v=q({levelNumber:x,seriesOptions:B.options,levelSeriesOptions:z,levelSeries:A,shapeArgs:E.shapeArgs,bBox:E.graphic?E.graphic.getBBox():{},color:E.isNull?new i.Color(l).setOpacity(0).get():l,lowerSeriesOptions:H,pointOptions:B.options.data[D],pointIndex:D,oldExtremes:{xMin:y&&y.userMin,xMax:y&&y.userMax,yMin:w&&w.userMin,yMax:w&&w.userMax},resetZoomButton:this.resetZoomButton},G);this.drilldownLevels.push(v);if(y&&y.names){y.names.length=0}C=v.lowerSeries=this.addSeries(H,false);C.options._levelNumber=x+1;if(y){y.oldPos=y.pos;y.userMin=y.userMax=null;w.userMin=w.userMax=null}if(B.type===C.type){C.animate=C.animateDrilldown||d;C.options.animation=true}};p.prototype.applyDrilldown=function(){var w=this.drilldownLevels,v;if(w&&w.length>0){v=w[w.length-1].levelNumber;e(this.drilldownLevels,function(x){if(x.levelNumber===v){e(x.levelSeries,function(y){if(y.options&&y.options._levelNumber===v){y.remove(false)}})}})}if(this.resetZoomButton){this.resetZoomButton.hide();delete this.resetZoomButton}this.pointer.reset();this.redraw();this.showDrillUpButton()};p.prototype.getDrilldownBackText=function(){var w=this.drilldownLevels,v;if(w&&w.length>0){v=w[w.length-1];v.series=v.seriesOptions;return m(this.options.lang.drillUpText,v)}};p.prototype.showDrillUpButton=function(){var x=this,y=this.getDrilldownBackText(),z=x.options.drilldown.drillUpButton,v,w;if(!this.drillUpButton){v=z.theme;w=v&&v.states;this.drillUpButton=this.renderer.button(y,null,null,function(){x.drillUp()},v,w&&w.hover,w&&w.select).addClass("highcharts-drillup-button").attr({align:z.position.align,zIndex:7}).add().align(z.position,false,z.relativeTo||"plotBox")}else{this.drillUpButton.attr({text:y}).align()}};p.prototype.drillUp=function(){if(!this.drilldownLevels||this.drilldownLevels.length===0){return}var C=this,x=C.drilldownLevels,w=x[x.length-1].levelNumber,z=x.length,F=C.series,E,v,A,B,y,D=function(G){var H;e(F,function(I){if(I.options._ddSeriesId===G._ddSeriesId){H=I}});H=H||C.addSeries(G,false);if(H.type===A.type&&H.animateDrillupTo){H.animate=H.animateDrillupTo}if(G===v.seriesOptions){B=H}};while(z--){v=x[z];if(v.levelNumber===w){x.pop();A=v.lowerSeries;if(!A.chart){E=F.length;while(E--){if(F[E].options.id===v.lowerSeriesOptions.id&&F[E].options._levelNumber===w+1){A=F[E];break}}}A.xData=[];e(v.levelSeriesOptions,D);u(C,"drillup",{seriesOptions:v.seriesOptions});if(B.type===A.type){B.drilldownLevel=v;B.options.animation=C.options.drilldown.animation;if(A.animateDrillupFrom&&A.chart){A.animateDrillupFrom(v)}}B.options._levelNumber=w;A.remove(false);if(B.xAxis){y=v.oldExtremes;B.xAxis.setExtremes(y.xMin,y.xMax,false);B.yAxis.setExtremes(y.yMin,y.yMax,false)}if(v.resetZoomButton){C.resetZoomButton=v.resetZoomButton;C.resetZoomButton.show()}}}u(C,"drillupall");this.redraw();if(this.drilldownLevels.length===0){this.drillUpButton=this.drillUpButton.destroy()}else{this.drillUpButton.attr({text:this.getDrilldownBackText()}).align()}this.ddDupes.length=[]};p.prototype.callbacks.push(function(){var v=this;v.drilldown={update:function(w,x){i.merge(true,v.options.drilldown,w);if(f(x,true)){v.redraw()}}}});i.addEvent(p,"beforeShowResetZoom",function(){if(this.drillUpButton){return false}});i.addEvent(p,"render",function s(){e(this.xAxis||[],function(v){v.ddPoints={};e(v.series,function(x){var w,A=x.xData||[],y=x.points,z;for(w=0;w<A.length;w++){z=x.options.data[w];if(typeof z!=="number"){z=x.pointClass.prototype.optionsToObject.call({series:x},z);if(z.drilldown){if(!v.ddPoints[A[w]]){v.ddPoints[A[w]]=[]}v.ddPoints[A[w]].push(y?y[w]:true)}}}});j(v.ticks,b.prototype.drillable)})});c.prototype.animateDrillupTo=function(w){if(!w){var v=this,x=v.drilldownLevel;e(this.points,function(y){var z=y.dataLabel;if(y.graphic){y.graphic.hide()}if(z){z.hidden=z.attr("visibility")==="hidden";if(!z.hidden){z.hide();if(y.connector){y.connector.hide()}}}});i.syncTimeout(function(){if(v.points){e(v.points,function(y,B){var C=B===(x&&x.pointIndex)?"show":"fadeIn",z=C==="show"?true:undefined,A=y.dataLabel;if(y.graphic){y.graphic[C](z)}if(A&&!A.hidden){A.fadeIn();if(y.connector){y.connector.fadeIn()}}})}},Math.max(this.chart.options.drilldown.animation.duration-50,0));this.animate=d}};c.prototype.animateDrilldown=function(z){var v=this,A=this.chart.drilldownLevels,w,y=g(this.chart.options.drilldown.animation),x=this.xAxis;if(!z){e(A,function(B){if(v.options._ddSeriesId===B.lowerSeriesOptions._ddSeriesId){w=B.shapeArgs;w.fill=B.color}});w.x+=(f(x.oldPos,x.pos)-x.pos);e(this.points,function(B){var C=B.shapeArgs;C.fill=B.color;if(B.graphic){B.graphic.attr(w).animate(q(B.shapeArgs,{fill:B.color||v.color}),y)}if(B.dataLabel){B.dataLabel.fadeIn(y)}});this.animate=null}};c.prototype.animateDrillupFrom=function(z){var x=g(this.chart.options.drilldown.animation),w=this.group,y=w!==this.chart.columnGroup,v=this;e(v.trackerGroups,function(A){if(v[A]){v[A].on("mouseover")}});if(y){delete this.group}e(this.points,function(A){var D=A.graphic,C=z.shapeArgs,B=function(){D.destroy();if(w&&y){w=w.destroy()}};if(D){delete A.graphic;C.fill=z.color;if(x.duration){D.animate(C,i.merge(x,{complete:B}))}else{D.attr(C);B()}}})};if(n){q(n.prototype,{animateDrillupTo:c.prototype.animateDrillupTo,animateDrillupFrom:c.prototype.animateDrillupFrom,animateDrilldown:function(z){var B=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],x=this.chart.options.drilldown.animation,w=B.shapeArgs,A=w.start,y=w.end-A,v=y/this.points.length;if(!z){e(this.points,function(C,E){var D=C.shapeArgs;w.fill=B.color;D.fill=C.color;if(C.graphic){C.graphic.attr(i.merge(w,{start:A+E*v,end:A+(E+1)*v}))[x?"animate":"attr"](D,x)}});this.animate=null}}})}i.Point.prototype.doDrilldown=function(y,C,v){var A=this.series,B=A.chart,w=B.options.drilldown,z=(w.series||[]).length,x;if(!B.ddDupes){B.ddDupes=[]}while(z--&&!x){if(w.series[z].id===this.drilldown&&o(this.drilldown,B.ddDupes)===-1){x=w.series[z];B.ddDupes.push(this.drilldown)}}u(B,"drilldown",{point:this,seriesOptions:x,category:C,originalEvent:v,points:(C!==undefined&&this.series.xAxis.getDDPoints(C).slice(0))},function(F){var E=F.point.series&&F.point.series.chart,D=F.seriesOptions;if(E&&D){if(y){E.addSingleSeriesAsDrilldown(F.point,D)}else{E.addSeriesAsDrilldown(F.point,D)}}})};i.Axis.prototype.drilldownCategory=function(v,w){j(this.getDDPoints(v),function(x){if(x&&x.series&&x.series.visible&&x.doDrilldown){x.doDrilldown(true,v,w)}});this.chart.applyDrilldown()};i.Axis.prototype.getDDPoints=function(v){return this.ddPoints&&this.ddPoints[v]};b.prototype.drillable=function(){var z=this.pos,v=this.label,w=this.axis,x=w.coll==="xAxis"&&w.getDDPoints,y=x&&w.getDDPoints(z);if(x){if(v&&y&&y.length){v.drillable=true;if(!v.basicStyles){v.basicStyles=i.merge(v.styles)}v.addClass("highcharts-drilldown-axis-label").css(w.chart.options.drilldown.activeAxisLabelStyle).on("click",function(A){w.drilldownCategory(z,A)})}else{if(v&&v.drillable){v.styles={};v.css(v.basicStyles);v.on("click",null);v.removeClass("highcharts-drilldown-axis-label")}}}};i.addEvent(i.Point,"afterInit",function(){var v=this,w=v.series;if(v.drilldown){i.addEvent(v,"click",function(x){if(w.xAxis&&w.chart.options.drilldown.allowPointDrilldown===false){w.xAxis.drilldownCategory(v.x,x)}else{v.doDrilldown(undefined,undefined,x)}})}return v});i.addEvent(i.Series,"afterDrawDataLabels",function(){var v=this.chart.options.drilldown.activeDataLabelStyle,w=this.chart.renderer;e(this.points,function(x){var y=x.options.dataLabels,z=f(x.dlOptions,y&&y.style,{});if(x.drilldown&&x.dataLabel){if(v.color==="contrast"){z.color=w.getContrast(x.color||this.color)}if(y&&y.color){z.color=y.color}x.dataLabel.addClass("highcharts-drilldown-data-label");x.dataLabel.css(v).css(z)}},this)});var h=function(v,x,w){v[w?"addClass":"removeClass"]("highcharts-drilldown-point");v.css({cursor:x})};i.addEvent(i.Series,"afterDrawTracker",function(){e(this.points,function(v){if(v.drilldown&&v.graphic){h(v.graphic,"pointer",true)}})});i.addEvent(i.Point,"afterSetState",function(){if(this.drilldown&&this.series.halo&&this.state==="hover"){h(this.series.halo,"pointer",true)}else{if(this.series.halo){h(this.series.halo,"auto",false)}}})}(a));return(function(){}())}));