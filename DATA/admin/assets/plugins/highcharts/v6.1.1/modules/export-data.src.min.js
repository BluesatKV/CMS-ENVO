"use strict";(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(b){b.ajax=function(c){var d=b.merge(true,{url:false,type:"GET",dataType:"json",success:false,error:false,data:false,headers:{}},c),h={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"},f=new XMLHttpRequest();function i(j,e){if(d.error){d.error(j,e)}else{}}if(!d.url){return false}f.open(d.type.toUpperCase(),d.url,true);f.setRequestHeader("Content-Type",h[d.dataType]||h.text);b.objectEach(d.headers,function(j,e){f.setRequestHeader(e,j)});f.onreadystatechange=function(){var j;if(f.readyState===4){if(f.status===200){j=f.responseText;if(d.dataType==="json"){try{j=JSON.parse(j)}catch(k){return i(f,k)}}return d.success&&d.success(j)}i(f,f.responseText)}};try{d.data=JSON.stringify(d.data)}catch(g){}f.send(d.data||true)}}(a));(function(c){var d=c.defined,i=c.each,g=c.pick,h=c.win,j=h.document,e=c.seriesTypes,k=j.createElement("a").download!==undefined;function f(l){return l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}c.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:false,useMultiLevelHeaders:true,useRowspanHeaders:true},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}});c.addEvent(c.Chart,"render",function(){if(this.options&&this.options.exporting&&this.options.exporting.showTable){this.viewData()}});c.Chart.prototype.setUpKeyToAxis=function(){if(e.arearange){e.arearange.prototype.keyToAxis={low:"y",high:"y"}}};c.Chart.prototype.getDataRows=function(B){var r=this.time,C=(this.options.exporting&&this.options.exporting.csv)||{},t,m=this.xAxis,u={},w=[],D,s=[],n=[],q,A,v,l,y=function(G,E,x){if(C.columnHeaderFormatter){var F=C.columnHeaderFormatter(G,E,x);if(F!==false){return F}}if(!G){return"Category"}if(G instanceof c.Axis){return(G.options.title&&G.options.title.text)||(G.isDatetimeAxis?"DateTime":"Category")}if(B){return{columnTitle:x>1?E:G.name,topLevelColumnTitle:G.name}}return G.name+(x>1?" ("+E+")":"")},z=[];A=0;this.setUpKeyToAxis();i(this.series,function(F){var N=F.options.keys,x=N||F.pointArrayMap||["y"],M=x.length,J=!F.requireSorting&&{},I={},H={},G=c.inArray(F.xAxis,m),L,E;i(x,function(P){var O=((F.keyToAxis&&F.keyToAxis[P])||P)+"Axis";I[P]=(F[O]&&F[O].categories)||[];H[P]=(F[O]&&F[O].isDatetimeAxis)});if(F.options.includeInCSVExport!==false&&!F.options.isInternal&&F.visible!==false){if(!c.find(z,function(O){return O[0]===G})){z.push([G,A])}E=0;while(E<M){q=y(F,x[E],x.length);n.push(q.columnTitle||q);if(B){s.push(q.topLevelColumnTitle||q)}E++}L={chart:F.chart,autoIncrement:F.autoIncrement,options:F.options,pointArrayMap:F.pointArrayMap};i(F.options.data,function K(R,P){var S,U,T,Q,O;O={series:L};F.pointClass.prototype.applyOptions.apply(O,[R]);S=O.x;Q=F.data[P]&&F.data[P].name;if(J){if(J[S]){S+="|"+P}J[S]=true}E=0;if(!F.xAxis||F.exportKey==="name"){S=Q}if(!u[S]){u[S]=[];u[S].xValues=[]}u[S].x=O.x;u[S].name=Q;u[S].xValues[G]=O.x;while(E<M){U=x[E];T=O[U];u[S][A+E]=g(I[U][T],H[U]?r.dateFormat(C.dateFormat,T):null,T);E++}});A=A+E}});for(v in u){if(u.hasOwnProperty(v)){w.push(u[v])}}var p,o;D=B?[s,n]:[n];A=z.length;while(A--){p=z[A][0];o=z[A][1];t=m[p];w.sort(function(E,x){return E.xValues[p]-x.xValues[p]});l=y(t);D[0].splice(o,0,l);if(B&&D[1]){D[1].splice(o,0,l)}i(w,function(E){var x=E.name;if(t&&!d(x)){if(t.isDatetimeAxis){if(E.x instanceof Date){E.x=E.x.getTime()}x=r.dateFormat(C.dateFormat,E.x)}else{if(t.categories){x=g(t.names[E.x],t.categories[E.x],E.x)}else{x=E.x}}}E.splice(o,0,x)})}D=D.concat(w);c.fireEvent(this,"exportData",{dataRows:D});return D};c.Chart.prototype.getCSV=function(n){var m="",r=this.getDataRows(),o=this.options.exporting.csv,l=g(o.decimalPoint,o.itemDelimiter!==","&&n?(1.1).toLocaleString()[1]:"."),q=g(o.itemDelimiter,l===","?";":","),p=o.lineDelimiter;i(r,function(v,t){var u="",s=v.length;while(s--){u=v[s];if(typeof u==="string"){u='"'+u+'"'}if(typeof u==="number"){if(l!=="."){u=u.toString().replace(".",l)}}v[s]=u}m+=v.join(q);if(t<r.length-1){m+=p}});return m};c.Chart.prototype.getTable=function(p){var u="<table>",y=this.options,n=p?(1.1).toLocaleString()[1]:".",m=g(y.exporting.useMultiLevelHeaders,true),x=this.getDataRows(m),q=0,v=m?x.shift():null,l=x.shift(),s=function(B,A){var z=B.length;if(A.length===z){while(z--){if(B[z]!==A[z]){return false}}}else{return false}return true},r=function(z,B,A,D){var E=g(D,""),C="text"+(B?" "+B:"");if(typeof E==="number"){E=E.toString();if(n===","){E=E.replace(".",n)}C="number"}else{if(!D){C="empty"}}return"<"+z+(A?" "+A:"")+' class="'+C+'">'+E+"</"+z+">"},o=function(H,B,z){var E="<thead>",C=0,F=z||B&&B.length,D,I,G=0,A;if(m&&H&&B&&!s(H,B)){E+="<tr>";for(;C<F;++C){I=H[C];D=H[C+1];if(I===D){++G}else{if(G){E+=r("th","highcharts-table-topheading",'scope="col" colspan="'+(G+1)+'"',I);G=0}else{if(I===B[C]){if(y.exporting.useRowspanHeaders){A=2;delete B[C]}else{A=1;B[C]=""}}else{A=1}E+=r("th","highcharts-table-topheading",'scope="col"'+(A>1?' valign="top" rowspan="'+A+'"':""),I)}}}E+="</tr>"}if(B){E+="<tr>";for(C=0,F=B.length;C<F;++C){if(B[C]!==undefined){E+=r("th",null,'scope="col"',B[C])}}E+="</tr>"}E+="</thead>";return E};if(y.exporting.tableCaption!==false){u+='<caption class="highcharts-table-caption">'+g(y.exporting.tableCaption,(y.title.text?f(y.title.text):"Chart"))+"</caption>"}for(var t=0,w=x.length;t<w;++t){if(x[t].length>q){q=x[t].length}}u+=o(v,l,Math.max(q,l.length));u+="<tbody>";i(x,function(A){u+="<tr>";for(var z=0;z<q;z++){u+=r(z?"td":"th",null,z?"":'scope="row"',A[z])}u+="</tr>"});u+="</tbody></table>";return u};c.Chart.prototype.fileDownload=function(n,q,p){var m,l,o;if(this.options.exporting.filename){o=this.options.exporting.filename}else{if(this.title&&this.title.textStr){o=this.title.textStr.replace(/ /g,"-").toLowerCase()}else{o="chart"}}if(h.Blob&&h.navigator.msSaveOrOpenBlob){l=new h.Blob(["\uFEFF"+p],{type:"text/csv"});h.navigator.msSaveOrOpenBlob(l,o+"."+q)}else{if(k){m=j.createElement("a");m.href=n;m.download=o+"."+q;this.container.appendChild(m);m.click();m.remove()}else{c.error("The browser doesn't support downloading files")}}};c.Chart.prototype.downloadCSV=function(){var l=this.getCSV(true);this.fileDownload("data:text/csv,\uFEFF"+encodeURIComponent(l),"csv",l,"text/csv")};c.Chart.prototype.downloadXLS=function(){var n="data:application/vnd.ms-excel;base64,",m='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(true)+"</body></html>",l=function(o){return h.btoa(unescape(encodeURIComponent(o)))};this.fileDownload(n+l(m),"xls",m,"application/vnd.ms-excel")};c.Chart.prototype.viewData=function(){if(!this.dataTableDiv){this.dataTableDiv=j.createElement("div");this.dataTableDiv.className="highcharts-data-table";this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)}this.dataTableDiv.innerHTML=this.getTable()};c.Chart.prototype.openInCloud=function(){var l,m,p;function o(q){Object.keys(q).forEach(function(r){if(typeof q[r]==="function"){delete q[r]}if(c.isObject(q[r])){o(q[r])}})}function n(){var r=j.createElement("form");j.body.appendChild(r);r.method="post";r.action="https://cloud-api.highcharts.com/openincloud";r.target="_blank";var q=j.createElement("input");q.type="hidden";q.name="chart";q.value=p;r.appendChild(q);r.submit();j.body.removeChild(r)}l=c.merge(this.userOptions);o(l);m={name:(l.title&&l.title.text)||"Chart title",options:l,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}};p=JSON.stringify(m);n()};var b=c.getOptions().exporting;if(b){c.extend(b.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}});b.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud")}if(e.map){e.map.prototype.exportKey="name"}if(e.mapbubble){e.mapbubble.prototype.exportKey="name"}if(e.treemap){e.treemap.prototype.exportKey="name"}}(a));return(function(){}())}));