(function(a){"object"===typeof module&&module.exports?module.exports=a:a(Highcharts)})(function(a){(function(b){b.ajax=function(f){var g=b.merge(!0,{url:!1,type:"GET",dataType:"json",success:!1,error:!1,data:!1,headers:{}},f);f={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var d=new XMLHttpRequest;if(!g.url){return !1}d.open(g.type.toUpperCase(),g.url,!0);d.setRequestHeader("Content-Type",f[g.dataType]||f.text);b.objectEach(g.headers,function(h,i){d.setRequestHeader(i,h)});d.onreadystatechange=function(){var c;if(4===d.readyState){if(200===d.status){c=d.responseText;if("json"===g.dataType){try{c=JSON.parse(c)}catch(h){g.error&&g.error(d,h);return}}return g.success&&g.success(c)}g.error&&g.error(d,d.responseText)}};try{g.data=JSON.stringify(g.data)}catch(e){}d.send(g.data||!0)}})(a);(function(k){var j=k.defined,i=k.each,g=k.pick,l=k.win,h=l.document,f=k.seriesTypes,d=void 0!==h.createElement("a").download;k.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}});k.addEvent(k.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&this.viewData()});k.Chart.prototype.setUpKeyToAxis=function(){f.arearange&&(f.arearange.prototype.keyToAxis={low:"y",high:"y"})};k.Chart.prototype.getDataRows=function(C){var z=this.time,u=this.options.exporting&&this.options.exporting.csv||{},G,s=this.xAxis,m={},F=[],q,c=[],K=[],p,J,t,L=function(e,v,n){if(u.columnHeaderFormatter){var r=u.columnHeaderFormatter(e,v,n);if(!1!==r){return r}}return e?e instanceof k.Axis?e.options.title&&e.options.title.text||(e.isDatetimeAxis?"DateTime":"Category"):C?{columnTitle:1<n?v:e.name,topLevelColumnTitle:e.name}:e.name+(1<n?" ("+v+")":""):"Category"},o=[];J=0;this.setUpKeyToAxis();i(this.series,function(E){var B=E.options.keys||E.pointArrayMap||["y"],w=B.length,M=!E.requireSorting&&{},v={},A={},D=k.inArray(E.xAxis,s),r,N;i(B,function(n){var e=(E.keyToAxis&&E.keyToAxis[n]||n)+"Axis";v[n]=E[e]&&E[e].categories||[];A[n]=E[e]&&E[e].isDatetimeAxis});if(!1!==E.options.includeInCSVExport&&!E.options.isInternal&&!1!==E.visible){k.find(o,function(e){return e[0]===D})||o.push([D,J]);for(N=0;N<w;){p=L(E,B[N],B.length),K.push(p.columnTitle||p),C&&c.push(p.topLevelColumnTitle||p),N++}r={chart:E.chart,autoIncrement:E.autoIncrement,options:E.options,pointArrayMap:E.pointArrayMap};i(E.options.data,function(n,x){var y,e;e={series:r};E.pointClass.prototype.applyOptions.apply(e,[n]);n=e.x;y=E.data[x]&&E.data[x].name;M&&(M[n]&&(n+="|"+x),M[n]=!0);N=0;E.xAxis&&"name"!==E.exportKey||(n=y);m[n]||(m[n]=[],m[n].xValues=[]);m[n].x=e.x;m[n].name=y;for(m[n].xValues[D]=e.x;N<w;){x=B[N],y=e[x],m[n][J+N]=g(v[x][y],A[x]?z.dateFormat(u.dateFormat,y):null,y),N++}});J+=N}});for(q in m){m.hasOwnProperty(q)&&F.push(m[q])}var I,H;q=C?[c,K]:[K];for(J=o.length;J--;){I=o[J][0],H=o[J][1],G=s[I],F.sort(function(e,n){return e.xValues[I]-n.xValues[I]}),t=L(G),q[0].splice(H,0,t),C&&q[1]&&q[1].splice(H,0,t),i(F,function(e){var n=e.name;G&&!j(n)&&(G.isDatetimeAxis?(e.x instanceof Date&&(e.x=e.x.getTime()),n=z.dateFormat(u.dateFormat,e.x)):n=G.categories?g(G.names[e.x],G.categories[e.x],e.x):e.x);e.splice(H,0,n)})}q=q.concat(F);k.fireEvent(this,"exportData",{dataRows:q});return q};k.Chart.prototype.getCSV=function(m){var o="",n=this.getDataRows(),s=this.options.exporting.csv,c=g(s.decimalPoint,","!==s.itemDelimiter&&m?(1.1).toLocaleString()[1]:"."),r=g(s.itemDelimiter,","===c?";":","),q=s.lineDelimiter;i(n,function(e,t){for(var u,p=e.length;p--;){u=e[p],"string"===typeof u&&(u='"'+u+'"'),"number"===typeof u&&"."!==c&&(u=u.toString().replace(".",c)),e[p]=u}o+=e.join(r);t<n.length-1&&(o+=q)});return o};k.Chart.prototype.getTable=function(y){var t="\x3ctable\x3e",s=this.options,x=y?(1.1).toLocaleString()[1]:".",r=g(s.exporting.useMultiLevelHeaders,!0);y=this.getDataRows(r);var w=0,m=r?y.shift():null,o=y.shift(),c=function(n,u,q,e){var p=g(e,"");u="text"+(u?" "+u:"");"number"===typeof p?(p=p.toString(),","===x&&(p=p.replace(".",x)),u="number"):e||(u="empty");return"\x3c"+n+(q?" "+q:"")+' class\x3d"'+u+'"\x3e'+p+"\x3c/"+n+"\x3e"};!1!==s.exporting.tableCaption&&(t+='\x3ccaption class\x3d"highcharts-table-caption"\x3e'+g(s.exporting.tableCaption,s.title.text?s.title.text.replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;").replace(/"/g,"\x26quot;").replace(/'/g,"\x26#x27;").replace(/\//g,"\x26#x2F;"):"Chart")+"\x3c/caption\x3e");for(var z=0,A=y.length;z<A;++z){y[z].length>w&&(w=y[z].length)}t+=function(p,C,D){var v="\x3cthead\x3e",B=0;D=D||C&&C.length;var q,n,u=0;if(n=r&&p&&C){p:if(n=p.length,C.length===n){for(;n--;){if(p[n]!==C[n]){n=!1;break p}}n=!0}else{n=!1}n=!n}if(n){for(v+="\x3ctr\x3e";B<D;++B){n=p[B],q=p[B+1],n===q?++u:u?(v+=c("th","highcharts-table-topheading",'scope\x3d"col" colspan\x3d"'+(u+1)+'"',n),u=0):(n===C[B]?s.exporting.useRowspanHeaders?(q=2,delete C[B]):(q=1,C[B]=""):q=1,v+=c("th","highcharts-table-topheading",'scope\x3d"col"'+(1<q?' valign\x3d"top" rowspan\x3d"'+q+'"':""),n))}v+="\x3c/tr\x3e"}if(C){v+="\x3ctr\x3e";B=0;for(D=C.length;B<D;++B){void 0!==C[B]&&(v+=c("th",null,'scope\x3d"col"',C[B]))}v+="\x3c/tr\x3e"}return v+"\x3c/thead\x3e"}(m,o,Math.max(w,o.length));t+="\x3ctbody\x3e";i(y,function(e){t+="\x3ctr\x3e";for(var n=0;n<w;n++){t+=c(n?"td":"th",null,n?"":'scope\x3d"row"',e[n])}t+="\x3c/tr\x3e"});return t+="\x3c/tbody\x3e\x3c/table\x3e"};k.Chart.prototype.fileDownload=function(o,m,e){var n;n=this.options.exporting.filename?this.options.exporting.filename:this.title&&this.title.textStr?this.title.textStr.replace(/ /g,"-").toLowerCase():"chart";l.Blob&&l.navigator.msSaveOrOpenBlob?(o=new l.Blob(["\ufeff"+e],{type:"text/csv"}),l.navigator.msSaveOrOpenBlob(o,n+"."+m)):d?(e=h.createElement("a"),e.href=o,e.download=n+"."+m,this.container.appendChild(e),e.click(),e.remove()):k.error("The browser doesn't support downloading files")};k.Chart.prototype.downloadCSV=function(){var c=this.getCSV(!0);this.fileDownload("data:text/csv,\ufeff"+encodeURIComponent(c),"csv",c,"text/csv")};k.Chart.prototype.downloadXLS=function(){var c='\x3chtml xmlns:o\x3d"urn:schemas-microsoft-com:office:office" xmlns:x\x3d"urn:schemas-microsoft-com:office:excel" xmlns\x3d"http://www.w3.org/TR/REC-html40"\x3e\x3chead\x3e\x3c!--[if gte mso 9]\x3e\x3cxml\x3e\x3cx:ExcelWorkbook\x3e\x3cx:ExcelWorksheets\x3e\x3cx:ExcelWorksheet\x3e\x3cx:Name\x3eArk1\x3c/x:Name\x3e\x3cx:WorksheetOptions\x3e\x3cx:DisplayGridlines/\x3e\x3c/x:WorksheetOptions\x3e\x3c/x:ExcelWorksheet\x3e\x3c/x:ExcelWorksheets\x3e\x3c/x:ExcelWorkbook\x3e\x3c/xml\x3e\x3c![endif]--\x3e\x3cstyle\x3etd{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}\x3c/style\x3e\x3cmeta name\x3dProgId content\x3dExcel.Sheet\x3e\x3cmeta charset\x3dUTF-8\x3e\x3c/head\x3e\x3cbody\x3e'+this.getTable(!0)+"\x3c/body\x3e\x3c/html\x3e";this.fileDownload("data:application/vnd.ms-excel;base64,"+l.btoa(unescape(encodeURIComponent(c))),"xls",c,"application/vnd.ms-excel")};k.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=h.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling));this.dataTableDiv.innerHTML=this.getTable()};k.Chart.prototype.openInCloud=function(){function n(c){Object.keys(c).forEach(function(o){"function"===typeof c[o]&&delete c[o];k.isObject(c[o])&&n(c[o])})}var m,e;m=k.merge(this.userOptions);n(m);m={name:m.title&&m.title.text||"Chart title",options:m,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}};e=JSON.stringify(m);(function(){var o=h.createElement("form");h.body.appendChild(o);o.method="post";o.action="https://cloud-api.highcharts.com/openincloud";o.target="_blank";var p=h.createElement("input");p.type="hidden";p.name="chart";p.value=e;o.appendChild(p);o.submit();h.body.removeChild(o)})()};var b=k.getOptions().exporting;b&&(k.extend(b.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}}),b.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud"));f.map&&(f.map.prototype.exportKey="name");f.mapbubble&&(f.mapbubble.prototype.exportKey="name");f.treemap&&(f.treemap.prototype.exportKey="name")})(a)});