"use strict";(function(a){if(typeof module==="object"&&module.exports){module.exports=a}else{a(Highcharts)}}(function(a){(function(m){var c=3,e=m.addEvent,k=m.each,h=m.extend,o=m.isNumber,g=m.pick,i=m.Series,j=m.SVGRenderer,f=m.Chart;m.setOptions({plotOptions:{series:{label:{enabled:true,connectorAllowed:false,connectorNeighbourDistance:24,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}});function n(t,v,r,u,q,s){var p=((s-v)*(r-t))-((u-v)*(q-t));return p>0?true:p<0?false:true}function b(u,w,s,v,q,t,p,r){return n(u,w,q,t,p,r)!==n(s,v,q,t,p,r)&&n(u,w,s,v,q,t)!==n(u,w,s,v,p,r)}function l(p,z,q,v,s,u,r,t){return(b(p,z,p+q,z,s,u,r,t)||b(p+q,z,p+q,z+v,s,u,r,t)||b(p,z+v,p+q,z+v,s,u,r,t)||b(p,z,p,z+v,s,u,r,t))}j.prototype.symbols.connector=function(v,u,z,t,B){var r=B&&B.anchorX,q=B&&B.anchorY,A,s,p=z/2;if(o(r)&&o(q)){A=["M",r,q];s=u-q;if(s<0){s=-t-s}if(s<z){p=r<v+(z/2)?s:z-s}if(q>u+t){A.push("L",v+p,u+t)}else{if(q<u){A.push("L",v+p,u)}else{if(r<v){A.push("L",v,u+t/2)}else{if(r>v+z){A.push("L",v+z,u+t/2)}}}}}return A||[]};i.prototype.getPointsOnGraph=function(){if(!this.xAxis&&!this.yAxis){return}var r=16,E=this.points,C,v,x=[],F,K,J,I,G,A,D,H,q=this.graph||this.area,B=q.element,z=this.chart.inverted,t=this.xAxis,p=this.yAxis,u=z?p.pos:t.pos,s=z?t.pos:p.pos,y=g(this.options.label.onArea,!!this.area),w=p.getThreshold(this.options.threshold);if(this.getPointSpline&&B.getPointAtLength&&!y){if(q.toD){H=q.attr("d");q.attr({d:q.toD})}G=B.getTotalLength();for(F=0;F<G;F+=r){C=B.getPointAtLength(F);x.push({chartX:u+C.x,chartY:s+C.y,plotX:C.x,plotY:C.y})}if(H){q.attr({d:H})}C=E[E.length-1];C.chartX=u+C.plotX;C.chartY=s+C.plotY;x.push(C)}else{G=E.length;for(F=0;F<G;F+=1){C=E[F];v=E[F-1];C.chartX=u+C.plotX;C.chartY=s+C.plotY;if(y){C.chartCenterY=s+(C.plotY+g(C.yBottom,w))/2}if(F>0){K=Math.abs(C.chartX-v.chartX);J=Math.abs(C.chartY-v.chartY);I=Math.max(K,J);if(I>r){A=Math.ceil(I/r);for(D=1;D<A;D+=1){x.push({chartX:v.chartX+(C.chartX-v.chartX)*(D/A),chartY:v.chartY+(C.chartY-v.chartY)*(D/A),chartCenterY:v.chartCenterY+(C.chartCenterY-v.chartCenterY)*(D/A),plotX:v.plotX+(C.plotX-v.plotX)*(D/A),plotY:v.plotY+(C.plotY-v.plotY)*(D/A)})}}}if(o(C.plotY)){x.push(C)}}}return x};i.prototype.labelFontSize=function(q,p){return q+((this.sum/this.chart.labelSeriesMaxSum)*(p-q))+"px"};i.prototype.checkClearPoint=function(v,u,s,p){var E=Number.MAX_VALUE,I=Number.MAX_VALUE,C,L,D=this.options.label.connectorAllowed,z=g(this.options.label.onArea,!!this.area),B=this.chart,w,H,r=16,K,J,A,G,F;function q(y,x){return !(x.left>y.right||x.right<y.left||x.top>y.bottom||x.bottom<y.top)}function t(x,y){return x-y}for(G=0;G<B.boxesToAvoid.length;G+=1){if(q(B.boxesToAvoid[G],{left:v,right:v+s.width,top:u,bottom:u+s.height})){return false}}for(G=0;G<B.series.length;G+=1){w=B.series[G];H=w.interpolatedPoints;if(w.visible&&H){for(F=1;F<H.length;F+=1){if(H[F].chartX>=v-r&&H[F-1].chartX<=v+s.width+r){if(l(v,u,s.width,s.height,H[F-1].chartX,H[F-1].chartY,H[F].chartX,H[F].chartY)){return false}if(this===w&&!K&&p){K=l(v-r,u-r,s.width+2*r,s.height+2*r,H[F-1].chartX,H[F-1].chartY,H[F].chartX,H[F].chartY)}}if((D||K)&&(this!==w||z)){J=v+s.width/2-H[F].chartX;A=u+s.height/2-H[F].chartY;E=Math.min(E,J*J+A*A)}}if(!z&&D&&this===w&&((p&&!K)||E<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(F=1;F<H.length;F+=1){C=Math.min((Math.pow(v+s.width/2-H[F].chartX,2)+Math.pow(u+s.height/2-H[F].chartY,2)),(Math.pow(v-H[F].chartX,2)+Math.pow(u-H[F].chartY,2)),(Math.pow(v+s.width-H[F].chartX,2)+Math.pow(u-H[F].chartY,2)),(Math.pow(v+s.width-H[F].chartX,2)+Math.pow(u+s.height-H[F].chartY,2)),(Math.pow(v-H[F].chartX,2)+Math.pow(u+s.height-H[F].chartY,2)));if(C<I){I=C;L=H[F]}}K=true}}}return !p||K?{x:v,y:u,weight:t(E,L?I:0),connectorPoint:L}:false};f.prototype.drawSeriesLabels=function(){var q=this,p=this.labelSeries;q.boxesToAvoid=[];k(p,function(r){r.interpolatedPoints=r.getPointsOnGraph();k(r.options.label.boxesToAvoid||[],function(s){q.boxesToAvoid.push(s)})});k(q.series,function(D){if(!D.xAxis&&!D.yAxis){return}var t,C,z,L=[],r,P,s,J=D.options.label,I=q.inverted,A=I?D.yAxis.pos:D.xAxis.pos,v=I?D.xAxis.pos:D.yAxis.pos,R=q.inverted?D.yAxis.len:D.xAxis.len,w=q.inverted?D.xAxis.len:D.yAxis.len,O=D.interpolatedPoints,H=g(J.onArea,!!D.area),u=D.labelBySeries,F=J.minFontSize,E=J.maxFontSize;function B(S,U,T){return S>A&&S<=A+R-T.width&&U>=v&&U<=v+w-T.height}function Q(){if(u){D.labelBySeries=u.destroy()}}if(D.visible&&!D.isSeriesBoosting&&O){if(!u){D.labelBySeries=u=q.renderer.label(D.name,0,-9999,"connector").css(h({color:H?q.renderer.getContrast(D.color):D.color},D.options.label.style));if(F&&E){u.css({fontSize:D.labelFontSize(F,E)})}u.attr({padding:0,opacity:q.renderer.forExport?1:0,stroke:D.color,"stroke-width":1,zIndex:3}).add().animate({opacity:1},{duration:200})}t=u.getBBox();t.width=Math.round(t.width);for(P=O.length-1;P>0;P-=1){if(H){C=O[P].chartX-t.width/2;z=O[P].chartCenterY-t.height/2;if(B(C,z,t)){s=D.checkClearPoint(C,z,t)}if(s){L.push(s)}}else{C=O[P].chartX+c;z=O[P].chartY-t.height-c;if(B(C,z,t)){s=D.checkClearPoint(C,z,t)}if(s){L.push(s)}C=O[P].chartX+c;z=O[P].chartY+c;if(B(C,z,t)){s=D.checkClearPoint(C,z,t)}if(s){L.push(s)}C=O[P].chartX-t.width-c;z=O[P].chartY+c;if(B(C,z,t)){s=D.checkClearPoint(C,z,t)}if(s){L.push(s)}C=O[P].chartX-t.width-c;z=O[P].chartY-t.height-c;if(B(C,z,t)){s=D.checkClearPoint(C,z,t)}if(s){L.push(s)}}}if(J.connectorAllowed&&!L.length&&!H){for(C=A+R-t.width;C>=A;C-=16){for(z=v;z<v+w-t.height;z+=16){r=D.checkClearPoint(C,z,t,true);if(r){L.push(r)}}}}if(L.length){L.sort(function(y,x){return x.weight-y.weight});s=L[0];q.boxesToAvoid.push({left:s.x,right:s.x+t.width,top:s.y,bottom:s.y+t.height});var K=Math.sqrt(Math.pow(Math.abs(s.x-u.x),2),Math.pow(Math.abs(s.y-u.y),2));if(K){var M={opacity:q.renderer.forExport?1:0,x:s.x,y:s.y},N={opacity:1};if(K<=10){N={x:M.x,y:M.y};M={}}D.labelBySeries.attr(h(M,{anchorX:s.connectorPoint&&s.connectorPoint.plotX+A,anchorY:s.connectorPoint&&s.connectorPoint.plotY+v})).animate(N);D.options.kdNow=true;D.buildKDTree();var G=D.searchPoint({chartX:s.x,chartY:s.y},true);u.closest=[G,s.x-G.plotX,s.y-G.plotY]}}else{Q()}}else{Q()}})};function d(){var r=this,q=Math.max(m.animObject(r.renderer.globalAnimation).duration,250),p=!r.hasRendered;r.labelSeries=[];r.labelSeriesMaxSum=0;m.clearTimeout(r.seriesLabelTimer);k(r.series,function(u){var t=u.options.label,s=u.labelBySeries,v=s&&s.closest;if(t.enabled&&u.visible&&(u.graph||u.area)&&!u.isSeriesBoosting){r.labelSeries.push(u);if(t.minFontSize&&t.maxFontSize){u.sum=m.reduce(u.yData,function(x,w){return(x||0)+(w||0)},0);r.labelSeriesMaxSum=Math.max(r.labelSeriesMaxSum,u.sum)}if(p){q=Math.max(q,m.animObject(u.options.animation).duration)}if(v){if(v[0].plotX!==undefined){s.animate({x:v[0].plotX+v[1],y:v[0].plotY+v[2]})}else{s.attr({opacity:0})}}}});r.seriesLabelTimer=m.syncTimeout(function(){if(r.series&&r.labelSeries){r.drawSeriesLabels()}},r.renderer.forExport?0:q)}e(f,"render",d)}(a));return(function(){}())}));