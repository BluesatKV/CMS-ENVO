(function(a){"object"===typeof module&&module.exports?module.exports=a:a(Highcharts)})(function(a){(function(g){function c(s,n,o,p,r,q){s=(q-n)*(o-s)-(p-n)*(r-s);return 0<s?!0:0>s?!1:!0}function k(u,o,p,q,t,s,r,n){return c(u,o,t,s,r,n)!==c(p,q,t,s,r,n)&&c(u,o,p,q,t,s)!==c(u,o,p,q,r,n)}function f(u,o,p,q,t,s,r,n){return k(u,o,u+p,o,t,s,r,n)||k(u+p,o,u+p,o+q,t,s,r,n)||k(u,o+q,u+p,o+q,t,s,r,n)||k(u,o,u,o+q,t,s,r,n)}var b=g.addEvent,l=g.each,e=g.extend,i=g.isNumber,j=g.pick,h=g.Series,m=g.SVGRenderer,d=g.Chart;g.setOptions({plotOptions:{series:{label:{enabled:!0,connectorAllowed:!1,connectorNeighbourDistance:24,minFontSize:null,maxFontSize:null,onArea:null,style:{fontWeight:"bold"},boxesToAvoid:[]}}}});m.prototype.symbols.connector=function(t,u,v,o,s){var r=s&&s.anchorX;s=s&&s.anchorY;var q,n,p=v/2;i(r)&&i(s)&&(q=["M",r,s],n=u-s,0>n&&(n=-o-n),n<v&&(p=r<t+v/2?n:v-n),s>u+o?q.push("L",t+p,u+o):s<u?q.push("L",t+p,u):r<t?q.push("L",t,u+o/2):r>t+v&&q.push("L",t+v,u+o/2));return q||[]};h.prototype.getPointsOnGraph=function(){if(this.xAxis||this.yAxis){var y=this.points,z,A,s=[],x,w,u,r;w=this.graph||this.area;u=w.element;var t=this.chart.inverted,n=this.xAxis;z=this.yAxis;var B=t?z.pos:n.pos,t=t?n.pos:z.pos,n=j(this.options.label.onArea,!!this.area),o=z.getThreshold(this.options.threshold);if(this.getPointSpline&&u.getPointAtLength&&!n){w.toD&&(A=w.attr("d"),w.attr({d:w.toD}));r=u.getTotalLength();for(x=0;x<r;x+=16){z=u.getPointAtLength(x),s.push({chartX:B+z.x,chartY:t+z.y,plotX:z.x,plotY:z.y})}A&&w.attr({d:A});z=y[y.length-1];z.chartX=B+z.plotX;z.chartY=t+z.plotY;s.push(z)}else{for(r=y.length,x=0;x<r;x+=1){z=y[x];A=y[x-1];z.chartX=B+z.plotX;z.chartY=t+z.plotY;n&&(z.chartCenterY=t+(z.plotY+j(z.yBottom,o))/2);if(0<x&&(w=Math.abs(z.chartX-A.chartX),u=Math.abs(z.chartY-A.chartY),w=Math.max(w,u),16<w)){for(w=Math.ceil(w/16),u=1;u<w;u+=1){s.push({chartX:A.chartX+u/w*(z.chartX-A.chartX),chartY:A.chartY+u/w*(z.chartY-A.chartY),chartCenterY:A.chartCenterY+u/w*(z.chartCenterY-A.chartCenterY),plotX:A.plotX+u/w*(z.plotX-A.plotX),plotY:A.plotY+u/w*(z.plotY-A.plotY)})}}i(z.plotY)&&s.push(z)}}return s}};h.prototype.labelFontSize=function(o,n){return o+this.sum/this.chart.labelSeriesMaxSum*(n-o)+"px"};h.prototype.checkClearPoint=function(F,G,H,z){var E=Number.MAX_VALUE,D=Number.MAX_VALUE,C,x,A=this.options.label.connectorAllowed,s=j(this.options.label.onArea,!!this.area),I=this.chart,u,y,w,o,J,B;for(J=0;J<I.boxesToAvoid.length;J+=1){if(y=I.boxesToAvoid[J],B=F+H.width,u=G,w=G+H.height,!(F>y.right||B<y.left||u>y.bottom||w<y.top)){return !1}}for(J=0;J<I.series.length;J+=1){if(u=I.series[J],y=u.interpolatedPoints,u.visible&&y){for(B=1;B<y.length;B+=1){if(y[B].chartX>=F-16&&y[B-1].chartX<=F+H.width+16){if(f(F,G,H.width,H.height,y[B-1].chartX,y[B-1].chartY,y[B].chartX,y[B].chartY)){return !1}this===u&&!C&&z&&(C=f(F-16,G-16,H.width+32,H.height+32,y[B-1].chartX,y[B-1].chartY,y[B].chartX,y[B].chartY))}!A&&!C||this===u&&!s||(w=F+H.width/2-y[B].chartX,o=G+H.height/2-y[B].chartY,E=Math.min(E,w*w+o*o))}if(!s&&A&&this===u&&(z&&!C||E<Math.pow(this.options.label.connectorNeighbourDistance,2))){for(B=1;B<y.length;B+=1){C=Math.min(Math.pow(F+H.width/2-y[B].chartX,2)+Math.pow(G+H.height/2-y[B].chartY,2),Math.pow(F-y[B].chartX,2)+Math.pow(G-y[B].chartY,2),Math.pow(F+H.width-y[B].chartX,2)+Math.pow(G-y[B].chartY,2),Math.pow(F+H.width-y[B].chartX,2)+Math.pow(G+H.height-y[B].chartY,2),Math.pow(F-y[B].chartX,2)+Math.pow(G+H.height-y[B].chartY,2)),C<D&&(D=C,x=y[B])}C=!0}}}return !z||C?{x:F,y:G,weight:E-(x?D:0),connectorPoint:x}:!1};d.prototype.drawSeriesLabels=function(){var o=this,n=this.labelSeries;o.boxesToAvoid=[];l(n,function(p){p.interpolatedPoints=p.getPointsOnGraph();l(p.options.label.boxesToAvoid||[],function(q){o.boxesToAvoid.push(q)})});l(o.series,function(H){function G(q,p,r){return q>A&&q<=A+I-r.width&&p>=s&&p<=s+K-r.height}if(H.xAxis||H.yAxis){var F,E,D,z=[],B,v,y=H.options.label,x=o.inverted,A=x?H.yAxis.pos:H.xAxis.pos,s=x?H.xAxis.pos:H.yAxis.pos,I=o.inverted?H.yAxis.len:H.xAxis.len,K=o.inverted?H.xAxis.len:H.yAxis.len,C=H.interpolatedPoints,J=j(y.onArea,!!H.area),x=H.labelBySeries;F=y.minFontSize;E=y.maxFontSize;if(H.visible&&!H.isSeriesBoosting&&C){x||(H.labelBySeries=x=o.renderer.label(H.name,0,-9999,"connector").css(e({color:J?o.renderer.getContrast(H.color):H.color},H.options.label.style)),F&&E&&x.css({fontSize:H.labelFontSize(F,E)}),x.attr({padding:0,opacity:o.renderer.forExport?1:0,stroke:H.color,"stroke-width":1,zIndex:3}).add().animate({opacity:1},{duration:200}));F=x.getBBox();F.width=Math.round(F.width);for(v=C.length-1;0<v;--v){J?(E=C[v].chartX-F.width/2,D=C[v].chartCenterY-F.height/2):(E=C[v].chartX+3,D=C[v].chartY-F.height-3,G(E,D,F)&&(B=H.checkClearPoint(E,D,F)),B&&z.push(B),E=C[v].chartX+3,D=C[v].chartY+3,G(E,D,F)&&(B=H.checkClearPoint(E,D,F)),B&&z.push(B),E=C[v].chartX-F.width-3,D=C[v].chartY+3,G(E,D,F)&&(B=H.checkClearPoint(E,D,F)),B&&z.push(B),E=C[v].chartX-F.width-3,D=C[v].chartY-F.height-3),G(E,D,F)&&(B=H.checkClearPoint(E,D,F)),B&&z.push(B)}if(y.connectorAllowed&&!z.length&&!J){for(E=A+I-F.width;E>=A;E-=16){for(D=s;D<s+K-F.height;D+=16){(B=H.checkClearPoint(E,D,F,!0))&&z.push(B)}}}if(z.length){if(z.sort(function(q,p){return p.weight-q.weight}),B=z[0],o.boxesToAvoid.push({left:B.x,right:B.x+F.width,top:B.y,bottom:B.y+F.height}),z=Math.sqrt(Math.pow(Math.abs(B.x-x.x),2),Math.pow(Math.abs(B.y-x.y),2))){y={opacity:o.renderer.forExport?1:0,x:B.x,y:B.y},C={opacity:1},10>=z&&(C={x:y.x,y:y.y},y={}),H.labelBySeries.attr(e(y,{anchorX:B.connectorPoint&&B.connectorPoint.plotX+A,anchorY:B.connectorPoint&&B.connectorPoint.plotY+s})).animate(C),H.options.kdNow=!0,H.buildKDTree(),H=H.searchPoint({chartX:B.x,chartY:B.y},!0),x.closest=[H,B.x-H.plotX,B.y-H.plotY]}}else{x&&(H.labelBySeries=x.destroy())}}else{x&&(H.labelBySeries=x.destroy())}}})};b(d,"render",function(){var p=this,n=Math.max(g.animObject(p.renderer.globalAnimation).duration,250),o=!p.hasRendered;p.labelSeries=[];p.labelSeriesMaxSum=0;g.clearTimeout(p.seriesLabelTimer);l(p.series,function(q){var t=q.options.label,s=q.labelBySeries,r=s&&s.closest;t.enabled&&q.visible&&(q.graph||q.area)&&!q.isSeriesBoosting&&(p.labelSeries.push(q),t.minFontSize&&t.maxFontSize&&(q.sum=g.reduce(q.yData,function(v,u){return(v||0)+(u||0)},0),p.labelSeriesMaxSum=Math.max(p.labelSeriesMaxSum,q.sum)),o&&(n=Math.max(n,g.animObject(q.options.animation).duration)),r&&(void 0!==r[0].plotX?s.animate({x:r[0].plotX+r[1],y:r[0].plotY+r[2]}):s.attr({opacity:0})))});p.seriesLabelTimer=g.syncTimeout(function(){p.series&&p.labelSeries&&p.drawSeriesLabels()},p.renderer.forExport?0:n)})})(a)});