(function(a){"object"===typeof module&&module.exports?module.exports=a:a(Highcharts)})(function(a){(function(h){var b=h.defined,d=h.each,i=h.extend,g=h.seriesType,c=h.pick,j=h.Point;g("sankey","column",{colorByPoint:!0,curveFactor:0.33,dataLabels:{enabled:!0,backgroundColor:"none",crop:!1,nodeFormat:void 0,nodeFormatter:function(){return this.point.name},format:void 0,formatter:function(){return""},inside:!0},nodeWidth:20,nodePadding:10,showInLegend:!1,states:{hover:{linkOpacity:1}},tooltip:{followPointer:!0,headerFormat:'\x3cspan class\x3d"highcharts-header"\x3e{series.name}\x3c/span\x3e\x3cbr/\x3e',pointFormat:"{point.fromNode.name} \u2192 {point.toNode.name}: \x3cb\x3e{point.weight}\x3c/b\x3e\x3cbr/\x3e",nodeFormat:"{point.name}: \x3cb\x3e{point.sum}\x3c/b\x3e\x3cbr/\x3e"}},{isCartesian:!1,forceDL:!0,createNode:function(e){function f(n,m){return h.find(n,function(o){return o.id===m})}var l=f(this.nodes,e),k;l||(k=this.options.nodes&&f(this.options.nodes,e),l=(new j).init(this,i({className:"highcharts-node",isNode:!0,id:e,y:1},k)),l.linksTo=[],l.linksFrom=[],l.formatPrefix="node",l.name=l.name||l.id,l.getSum=function(){var n=0,m=0;d(l.linksTo,function(o){n+=o.weight});d(l.linksFrom,function(o){m+=o.weight});return Math.max(n,m)},l.offset=function(n,m){for(var o=0,p=0;p<l[m].length;p++){if(l[m][p]===n){return o}o+=l[m][p].weight}},l.hasShape=function(){var m=0;d(l.linksTo,function(n){n.outgoing&&m++});return !l.linksTo.length||m!==l.linksTo.length},this.nodes.push(l));return l},createNodeColumn:function(){var e=this.chart,f=[],k=this.options.nodePadding;f.sum=function(){var l=0;d(this,function(m){l+=m.getSum()});return l};f.offset=function(l,m){for(var o=0,n=0;n<f.length;n++){if(f[n]===l){return o+(l.options.offset||0)}o+=f[n].getSum()*m+k}};f.top=function(n){for(var l=0,m=0;m<f.length;m++){0<m&&(l+=k),l+=f[m].getSum()*n}return(e.plotSizeY-l)/2};return f},createNodeColumns:function(){var e=[];d(this.nodes,function(f){var m=-1,l,k;if(!h.defined(f.options.column)){if(0===f.linksTo.length){f.column=0}else{for(l=0;l<f.linksTo.length;l++){k=f.linksTo[0],k.fromNode.column>m&&(m=k.fromNode.column)}f.column=m+1}}e[f.column]||(e[f.column]=this.createNodeColumn());e[f.column].push(f)},this);return e},generatePoints:function(){var e={};h.Series.prototype.generatePoints.call(this);this.nodes||(this.nodes=[]);this.colorCounter=0;d(this.nodes,function(f){f.linksFrom.length=0;f.linksTo.length=0});d(this.points,function(f){b(f.from)&&(e[f.from]||(e[f.from]=this.createNode(f.from)),e[f.from].linksFrom.push(f),f.fromNode=e[f.from],f.colorIndex=c(f.options.colorIndex,e[f.from].colorIndex));b(f.to)&&(e[f.to]||(e[f.to]=this.createNode(f.to)),e[f.to].linksTo.push(f),f.toNode=e[f.to]);f.name=f.name||f.id},this)},translate:function(){this.processedXData||this.processData();this.generatePoints();this.nodeColumns=this.createNodeColumns();var s=this.chart,t=s.inverted,r=this.options,q=0,o=r.nodeWidth,n=this.nodeColumns,k=(s.plotSizeX-o)/(n.length-1),f=(t?-k:k)*r.curveFactor,l=Infinity;d(this.nodeColumns,function(e){l=Math.min(l,(s.plotSizeY-(e.length-1)*r.nodePadding)/e.sum())});d(this.nodeColumns,function(e){d(e,function(w){var x=w.getSum(),m=x*l,p=e.top(l)+e.offset(w,l),u=t?s.plotSizeX-q:q;w.sum=x;w.shapeType="rect";w.shapeArgs=t?{x:u-o,y:s.plotSizeY-p-m,width:o,height:m}:{x:u,y:p,width:o,height:m};w.shapeArgs.display=w.hasShape()?"":"none";w.plotY=1;d(w.linksFrom,function(ah){var af=ah.weight*l,ad=w.offset(ah,"linksFrom")*l,ad=p+ad,ae=ah.toNode,ag=n[ae.column].top(l)+ae.offset(ah,"linksTo")*l+n[ae.column].offset(ae,l),Z=o,ae=ae.column*k,T=ah.outgoing;t&&(ad=s.plotSizeY-ad,ag=s.plotSizeY-ag,ae=s.plotSizeX-ae,Z=-Z,af=-af);ah.shapeType="path";if(ae>q){ah.shapeArgs={d:["M",u+Z,ad,"C",u+Z+f,ad,ae-f,ag,ae,ag,"L",ae+(T?Z:0),ag+af/2,"L",ae,ag+af,"C",ae-f,ag+af,u+Z+f,ad+af,u+Z,ad+af,"z"]}}else{var T=ae-20-af,R=ae-20,ac=ae,P=u+Z,W=P+20,X=W+af,U=ad,N=ad+af,S=N+20,ab=S+(s.plotHeight-ad-af),Y=ab+20,V=Y+af,Q=ag,aa=Q+af,O=aa+20,G=Y+0.7*af,D=ac-0.7*af,C=P+0.7*af;ah.shapeArgs={d:["M",P,U,"C",C,U,X,N-0.7*af,X,S,"L",X,ab,"C",X,G,C,V,P,V,"L",ac,V,"C",D,V,T,G,T,ab,"L",T,O,"C",T,aa-0.7*af,D,Q,ac,Q,"L",ac,aa,"C",R,aa,R,aa,R,O,"L",R,ab,"C",R,Y,R,Y,ac,Y,"L",P,Y,"C",W,Y,W,Y,W,ab,"L",W,S,"C",W,N,W,N,P,N,"z"]}}ah.dlBox={x:u+(ae-u+Z)/2,y:ad+(ag-ad)/2,height:af,width:0};ah.y=ah.plotY=1;ah.color||(ah.color=w.color)})});q+=k},this)},render:function(){var e=this.points;this.points=this.points.concat(this.nodes);h.seriesTypes.column.prototype.render.call(this);this.points=e},animate:h.Series.prototype.animate},{getClassName:function(){return"highcharts-link "+j.prototype.getClassName.call(this)},isValid:function(){return this.isNode||"number"===typeof this.weight}})})(a)});