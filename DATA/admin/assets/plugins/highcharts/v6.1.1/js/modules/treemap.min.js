(function(a){"object"===typeof module&&module.exports?module.exports=a:a(Highcharts)})(function(a){var b=function(j){var m=j.each,l=j.extend,d=j.isArray,n=j.isObject,c=j.isNumber,e=j.merge,k=j.pick,h=j.reduce;return{getColor:function(x,w){var s=w.mapOptionsToLevel,y=w.parentColorIndex,u=w.series,t=w.colors,r=u.points,o,q;x&&(r=r[x.i],s=s[x.level]||{},(x=r&&s.colorByPoint)&&(o=r.index%(t?t.length:u.chart.options.chart.colorCount)),q=k(r&&r.options.colorIndex,s&&s.colorIndex,o,y,w.colorIndex));return{color:void 0,colorIndex:q}},getLevelOptions:function(g){var r=null,o,p,s,q;if(n(g)){for(r={},s=c(g.from)?g.from:1,q=g.levels,p={},o=n(g.defaults)?g.defaults:{},d(q)&&(p=h(q,function(t,w){var u,v;n(w)&&c(w.level)&&(v=e({},w),u="boolean"===typeof v.levelIsConstant?v.levelIsConstant:o.levelIsConstant,delete v.levelIsConstant,delete v.level,w=w.level+(u?0:s-1),n(t[w])?l(t[w],v):t[w]=v);return t},{})),q=c(g.to)?g.to:1,g=0;g<=q;g++){r[g]=e({},o,n(p[g])?p[g]:{})}}return r},setTreeValues:function i(y,x){var u=x.before,w=x.idRoot,s=x.mapIdToNode[w],o=x.points[y.i],A=o&&o.options||{},f=0,z=[];l(y,{levelDynamic:y.level-(("boolean"===typeof x.levelIsConstant?x.levelIsConstant:1)?0:s.level),name:k(o&&o.name,""),visible:w===y.id||("boolean"===typeof x.visible?x.visible:!1)});"function"===typeof u&&(y=u(y,x));m(y.children,function(p,g){var q=l({},x);l(q,{index:g,siblings:y.children.length,visible:y.visible});p=i(p,q);z.push(p);p.visible&&(f+=p.val)});y.visible=0<f||y.visible;u=k(A.value,f);l(y,{children:z,childrenTotal:f,isLeaf:y.visible&&!f,val:u});return y},updateRootId:function(f){var o;n(f)&&(o=n(f.options)?f.options:{},o=k(f.rootNode,o.rootId,""),n(f.userOptions)&&(f.userOptions.rootId=o),f.rootNode=o);return o}}}(a);(function(Q,m){var j=Q.seriesType,J=Q.seriesTypes,o=Q.map,F=Q.merge,K=Q.extend,e=Q.noop,O=Q.each,G=m.getColor,P=m.getLevelOptions,M=Q.grep,k=Q.isNumber,c=Q.isString,N=Q.pick,L=Q.Series,y=Q.stableSort,n=function(f,h,g){g=g||this;Q.objectEach(f,function(l,p){h.call(g,l,p,f)})},i=Q.reduce,s=function(f,h,g){g=g||this;f=h.call(g,f);!1!==f&&s(f,h,g)},d=m.updateRootId;j("treemap","scatter",{showInLegend:!1,marker:!1,colorByPoint:!1,dataLabels:{enabled:!0,defer:!1,verticalAlign:"middle",formatter:function(){return this.point.name||this.point.id},inside:!0},tooltip:{headerFormat:"",pointFormat:"\x3cb\x3e{point.name}\x3c/b\x3e: {point.value}\x3cbr/\x3e"},ignoreHiddenPoint:!0,layoutAlgorithm:"sliceAndDice",layoutStartingDirection:"vertical",alternateStartingDirection:!1,levelIsConstant:!0,drillUpButton:{position:{align:"right",x:-10,y:10}}},{pointArrayMap:["value"],axisTypes:J.heatmap?["xAxis","yAxis","colorAxis"]:["xAxis","yAxis"],directTouch:!0,optionalAxis:"colorAxis",getSymbol:e,parallelArrays:["x","y","value","colorValue"],colorKey:"colorValue",translateColors:J.heatmap&&J.heatmap.prototype.translateColors,colorAttribs:J.heatmap&&J.heatmap.prototype.colorAttribs,trackerGroups:["group","dataLabelsGroup"],getListOfParents:function(f,g){f=i(f||[],function(l,p,h){p=N(p.parent,"");void 0===l[p]&&(l[p]=[]);l[p].push(h);return l},{});n(f,function(h,p,l){""!==p&&-1===Q.inArray(p,g)&&(O(h,function(q){l[""].push(q)}),delete l[p])});return f},getTree:function(){var f=o(this.data,function(g){return g.id}),f=this.getListOfParents(this.data,f);this.nodeMap=[];return this.buildNode("",-1,0,f,null)},init:function(f,g){L.prototype.init.call(this,f,g);this.options.allowDrillToNode&&Q.addEvent(this,"click",this.onClickDrillToNode)},buildNode:function(t,q,p,r,l){var g=this,f=[],h=g.points[q],v=0,u;O(r[t]||[],function(w){u=g.buildNode(g.points[w].id,w,p+1,r,t);v=Math.max(u.height+1,v);f.push(u)});q={id:t,i:q,children:f,height:v,level:p,parent:l,visible:!1};g.nodeMap[q.id]=q;h&&(h.node=q);return q},setTreeValues:function(h){var t=this,q=t.options,g=t.nodeMap[t.rootNode],q="boolean"===typeof q.levelIsConstant?q.levelIsConstant:!0,p=0,f=[],r,l=t.points[h.i];O(h.children,function(u){u=t.setTreeValues(u);f.push(u);u.ignore||(p+=u.val)});y(f,function(u,v){return u.sortIndex-v.sortIndex});r=N(l&&l.options.value,p);l&&(l.value=r);K(h,{children:f,childrenTotal:p,ignore:!(N(l&&l.visible,!0)&&0<r),isLeaf:h.visible&&!p,levelDynamic:h.level-(q?0:g.level),name:N(l&&l.name,""),sortIndex:N(l&&l.sortIndex,-r),val:r});return h},calculateChildrenAreas:function(h,t){var q=this,g=q.options,p=q.mapOptionsToLevel[h.level+1],f=N(q[p&&p.layoutAlgorithm]&&p.layoutAlgorithm,g.layoutAlgorithm),r=g.alternateStartingDirection,l=[];h=M(h.children,function(u){return !u.ignore});p&&p.layoutStartingDirection&&(t.direction="vertical"===p.layoutStartingDirection?0:1);l=q[f](t,h);O(h,function(v,u){u=l[u];v.values=F(u,{val:v.childrenTotal,direction:r?1-t.direction:t.direction});v.pointValues=F(u,{x:u.x/q.axisRatio,width:u.width/q.axisRatio});v.children.length&&q.calculateChildrenAreas(v,v.values)})},setPointValues:function(){var f=this.xAxis,g=this.yAxis;O(this.points,function(r){var l=r.node,q=l.pointValues,h,p;q&&l.visible?(l=Math.round(f.translate(q.x,0,0,0,1))-0,h=Math.round(f.translate(q.x+q.width,0,0,0,1))-0,p=Math.round(g.translate(q.y,0,0,0,1))-0,q=Math.round(g.translate(q.y+q.height,0,0,0,1))-0,r.shapeType="rect",r.shapeArgs={x:Math.min(l,h),y:Math.min(p,q),width:Math.abs(h-l),height:Math.abs(q-p)},r.plotX=r.shapeArgs.x+r.shapeArgs.width/2,r.plotY=r.shapeArgs.y+r.shapeArgs.height/2):(delete r.plotX,delete r.plotY)})},setColorRecursive:function(h,t,q,g,p){var f=this,r=f&&f.chart,r=r&&r.options&&r.options.colors,l;if(h){l=G(h,{colors:r,index:g,mapOptionsToLevel:f.mapOptionsToLevel,parentColor:t,parentColorIndex:q,series:f,siblings:p});if(t=f.points[h.i]){t.color=l.color,t.colorIndex=l.colorIndex}O(h.children||[],function(v,u){f.setColorRecursive(v,l.color,l.colorIndex,u,h.children.length)})}},algorithmGroup:function(g,l,h,f){this.height=g;this.width=l;this.plot=f;this.startDirection=this.direction=h;this.lH=this.nH=this.lW=this.nW=this.total=0;this.elArr=[];this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(p,q){return Math.max(p/q,q/p)}};this.addElement=function(p){this.lP.total=this.elArr[this.elArr.length-1];this.total+=p;0===this.direction?(this.lW=this.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,this.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH));this.elArr.push(p)};this.reset=function(){this.lW=this.nW=0;this.elArr=[];this.total=0}},algorithmCalcPoints:function(I,E,D,H){var C,w,v,z,x=D.lW,A=D.lH,B=D.plot,t,g=0,u=D.elArr.length-1;E?(x=D.nW,A=D.nH):t=D.elArr[D.elArr.length-1];O(D.elArr,function(f){if(E||g<u){0===D.direction?(C=B.x,w=B.y,v=x,z=f/v):(C=B.x,w=B.y,z=A,v=f/z),H.push({x:C,y:w,width:v,height:z}),0===D.direction?B.y+=z:B.x+=v}g+=1});D.reset();0===D.direction?D.width-=x:D.height-=A;B.y=B.parent.y+(B.parent.height-D.height);B.x=B.parent.x+(B.parent.width-D.width);I&&(D.direction=1-D.direction);E||D.addElement(t)},algorithmLowAspectRatio:function(z,w,x){var v=[],u=this,g,t={x:w.x,y:w.y,parent:w},q=0,p=x.length-1,r=new this.algorithmGroup(w.height,w.width,w.direction,t);O(x,function(f){g=f.val/w.val*w.height*w.width;r.addElement(g);r.lP.nR>r.lP.lR&&u.algorithmCalcPoints(z,!1,r,v,t);q===p&&u.algorithmCalcPoints(z,!0,r,v,t);q+=1});return v},algorithmFill:function(I,E,H){var D=[],C,w=E.direction,B=E.x,z=E.y,A=E.width,x=E.height,u,g,v,R;O(H,function(f){C=f.val/E.val*E.height*E.width;u=B;g=z;0===w?(R=x,v=C/R,A-=v,B+=v):(v=A,R=C/v,x-=R,z+=R);D.push({x:u,y:g,width:v,height:R});I&&(w=1-w)});return D},strip:function(f,g){return this.algorithmLowAspectRatio(!1,f,g)},squarified:function(f,g){return this.algorithmLowAspectRatio(!0,f,g)},sliceAndDice:function(f,g){return this.algorithmFill(!0,f,g)},stripes:function(f,g){return this.algorithmFill(!1,f,g)},translate:function(){var g=this,p=g.options,f=d(g),l,h;L.prototype.translate.call(g);h=g.tree=g.getTree();l=g.nodeMap[f];g.mapOptionsToLevel=P({from:l.level+1,levels:p.levels,to:h.height,defaults:{levelIsConstant:g.options.levelIsConstant,colorByPoint:p.colorByPoint}});""===f||l&&l.children.length||(g.drillToNode("",!1),f=g.rootNode,l=g.nodeMap[f]);s(g.nodeMap[g.rootNode],function(q){var t=!1,r=q.parent;q.visible=!0;if(r||""===r){t=g.nodeMap[r]}return t});s(g.nodeMap[g.rootNode].children,function(r){var q=!1;O(r,function(t){t.visible=!0;t.children.length&&(q=(q||[]).concat(t.children))});return q});g.setTreeValues(h);g.axisRatio=g.xAxis.len/g.yAxis.len;g.nodeMap[""].pointValues=f={x:0,y:0,width:100,height:100};g.nodeMap[""].values=f=F(f,{width:f.width*g.axisRatio,direction:"vertical"===p.layoutStartingDirection?0:1,val:h.val});g.calculateChildrenAreas(h,f);g.colorAxis?g.translateColors():p.colorByPoint||g.setColorRecursive(g.tree);p.allowDrillToNode&&(p=l.pointValues,g.xAxis.setExtremes(p.x,p.x+p.width,!1),g.yAxis.setExtremes(p.y,p.y+p.height,!1),g.xAxis.setScale(),g.yAxis.setScale());g.setPointValues()},drawDataLabels:function(){var h=this,g=h.mapOptionsToLevel,q=M(h.points,function(f){return f.node.visible}),l,p;O(q,function(f){p=g[f.node.level];l={style:{}};f.node.isLeaf||(l.enabled=!1);p&&p.dataLabels&&(l=F(l,p.dataLabels),h._hasPointLabels=!0);f.shapeArgs&&(l.style.width=f.shapeArgs.width,f.dataLabel&&f.dataLabel.css({width:f.shapeArgs.width+"px"}));f.dlOptions=F(l,f.options.dataLabels)});L.prototype.drawDataLabels.call(this)},alignDataLabel:function(f){J.column.prototype.alignDataLabel.apply(this,arguments);f.dataLabel&&f.dataLabel.attr({zIndex:(f.node.zIndex||0)+1})},drawPoints:function(){var g=this,f=M(g.points,function(h){return h.node.visible});O(f,function(h){var l="level-group-"+h.node.levelDynamic;g[l]||(g[l]=g.chart.renderer.g(l).attr({zIndex:1000-h.node.levelDynamic}).add(g.group));h.group=g[l]});J.column.prototype.drawPoints.call(this);this.colorAttribs&&O(this.points,function(h){h.graphic&&h.graphic.css(this.colorAttribs(h))},this);g.options.allowDrillToNode&&O(f,function(h){h.graphic&&(h.drillId=g.options.interactByLeaf?g.drillToByLeaf(h):g.drillToByGroup(h))})},onClickDrillToNode:function(g){var f=(g=g.point)&&g.drillId;c(f)&&(g.setState(""),this.drillToNode(f))},drillToByGroup:function(g){var f=!1;1!==g.node.level-this.nodeMap[this.rootNode].level||g.node.isLeaf||(f=g.id);return f},drillToByLeaf:function(g){var f=!1;if(g.node.parent!==this.rootNode&&g.node.isLeaf){for(g=g.node;!f;){g=this.nodeMap[g.parent],g.parent===this.rootNode&&(f=g.id)}}return f},drillUp:function(){var f=this.nodeMap[this.rootNode];f&&c(f.parent)&&this.drillToNode(f.parent)},drillToNode:function(g,f){var h=this.nodeMap[g];this.idPreviousRoot=this.rootNode;this.rootNode=g;""===g?this.drillUpButton=this.drillUpButton.destroy():this.showDrillUpButton(h&&h.name||g);this.isDirty=!0;N(f,!0)&&this.chart.redraw()},showDrillUpButton:function(h){var g=this;h=h||"\x3c Back";var q=g.options.drillUpButton,l,p;q.text&&(h=q.text);this.drillUpButton?(this.drillUpButton.placed=!1,this.drillUpButton.attr({text:h}).align()):(p=(l=q.theme)&&l.states,this.drillUpButton=this.chart.renderer.button(h,null,null,function(){g.drillUp()},l,p&&p.hover,p&&p.select).addClass("highcharts-drillup-button").attr({align:q.position.align,zIndex:7}).add().align(q.position,!1,q.relativeTo||"plotBox"))},buildKDTree:e,drawLegendSymbol:Q.LegendSymbolMixin.drawRectangle,getExtremes:function(){L.prototype.getExtremes.call(this,this.colorValueData);this.valueMin=this.dataMin;this.valueMax=this.dataMax;L.prototype.getExtremes.call(this)},getExtremesFromAll:!0,bindAxes:function(){var f={endOnTick:!1,gridLineWidth:0,lineWidth:0,min:0,dataMin:0,minPadding:0,max:100,dataMax:100,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};L.prototype.bindAxes.call(this);Q.extend(this.yAxis.options,f);Q.extend(this.xAxis.options,f)},utils:{recursive:s,reduce:i}},{getClassName:function(){var f=Q.Point.prototype.getClassName.call(this),h=this.series,g=h.options;this.node.level<=h.nodeMap[h.rootNode].level?f+=" highcharts-above-level":this.node.isLeaf||N(g.interactByLeaf,!g.allowDrillToNode)?this.node.isLeaf||(f+=" highcharts-internal-node"):f+=" highcharts-internal-node-interactive";return f},isValid:function(){return this.id||k(this.value)},setState:function(f){Q.Point.prototype.setState.call(this,f);this.graphic&&this.graphic.attr({zIndex:"hover"===f?1:0})},setVisible:J.pie.prototype.pointClass.prototype.setVisible})})(a,b)});